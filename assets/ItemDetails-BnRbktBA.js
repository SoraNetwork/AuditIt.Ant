import{d as P,r as j,H as m,n as F,o as R,f as T,b as w,c as t,k as u,w as e,l as d,K as q,e as o,j as l,t as s,v as f,F as N,q as H,h as c}from"./index-D2Ey1OOG.js";import{u as V}from"./itemStore-LjhLjQKj.js";import{u as Y}from"./auditLogStore-B2Prt_57.js";import{u as J}from"./warehouseStore-BpXoAifH.js";import{u as O}from"./itemDefinitionStore-DURs3lbI.js";import{S as W}from"./constants-B77X9tuq.js";import{f as K}from"./formatters-BqeHoMtK.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"page-container"},X=P({__name:"ItemDetails",setup($){const U=T(),B=q(),A=V(),g=Y(),_=J(),p=O(),a=j(null),h=m(()=>a.value?.photoUrl?`${(F.defaults.baseURL||"").replace("/api","")}${a.value.photoUrl}`:null),v=m(()=>a.value?.status?W[a.value.status]||{text:"未知",color:"gray"}:{text:"加载中...",color:"gray"}),y=m(()=>p.itemDefinitions.find(n=>n.id===a.value?.itemDefinitionId)?.name||"加载中..."),Q=m(()=>_.warehouses.find(n=>n.id===a.value?.warehouseId)?.name||"加载中...");return R(async()=>{const n=U.params.id;_.warehouses.length===0&&_.fetchWarehouses(),p.itemDefinitions.length===0&&p.fetchItemDefinitions(),await A.fetchItems({id:n}),A.items.length>0&&(a.value=A.items[0],await g.fetchLogs({itemId:n}))}),(n,D)=>{const b=o("a-tag"),k=o("a-page-header"),r=o("a-descriptions-item"),x=o("a-descriptions"),S=o("a-col"),E=o("a-image"),L=o("a-empty"),M=o("a-row"),I=o("a-card"),C=o("a-timeline-item"),G=o("a-timeline");return c(),w("div",null,[t(k,{title:`物品详情: ${a.value?.shortId}`,onBack:D[0]||(D[0]=i=>d(B).back())},{extra:e(()=>[t(b,{color:v.value.color},{default:e(()=>[l(s(v.value.text),1)]),_:1},8,["color"])]),_:1},8,["title"]),u("div",z,[t(I,{loading:d(A).loading},{default:e(()=>[t(M,{gutter:16},{default:e(()=>[t(S,{span:16},{default:e(()=>[t(x,{bordered:"",column:2},{default:e(()=>[t(r,{label:"物品名称"},{default:e(()=>[l(s(y.value),1)]),_:1}),t(r,{label:"所属仓库"},{default:e(()=>[l(s(Q.value),1)]),_:1}),t(r,{label:"可视化ID"},{default:e(()=>[l(s(a.value?.shortId),1)]),_:1}),t(r,{label:"最后更新"},{default:e(()=>[l(s(d(K)(a.value?.lastUpdated)),1)]),_:1}),t(r,{label:"备注",span:2},{default:e(()=>[l(s(a.value?.remarks||"无"),1)]),_:1}),t(r,{label:"UUID",span:2},{default:e(()=>[l(s(a.value?.id),1)]),_:1})]),_:1})]),_:1}),t(S,{span:8},{default:e(()=>[h.value?(c(),f(E,{key:0,width:200,src:h.value,alt:"物品图片",fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBYSO_L2DLs_pWEnPErdAZ2Wa4AyGGz7Z1gAGAhImmwPAWIQLATAoPEwAX1Ls1GHi0AAAAAAABjWLNZaAAAABRnUExURQAAAPQ9Pfr6+vDw8Pv7+/T09P///9SoCg8AAAAlSURBVHja7cExAQAAAMKg9U9tCF8gAAAAAAAAAAAAAOD2A20AAAE42g4qAAAAAElFTkSuQmCC"},null,8,["src"])):(c(),f(L,{key:1,description:"暂无图片"}))]),_:1})]),_:1})]),_:1},8,["loading"]),t(I,{title:"生命周期日志",style:{"margin-top":"16px"}},{default:e(()=>[t(G,null,{default:e(()=>[(c(!0),w(N,null,H(d(g).logs,i=>(c(),f(C,{key:i.id},{default:e(()=>[u("p",null,[u("strong",null,s(i.action),1),l(" - "+s(i.timestamp),1)]),u("p",null,"操作人: "+s(i.user),1),u("p",null,"仓库: "+s(i.warehouseName),1)]),_:2},1024))),128))]),_:1})]),_:1})])])}}}),ie=Z(X,[["__scopeId","data-v-b07949d7"]]);export{ie as default};
