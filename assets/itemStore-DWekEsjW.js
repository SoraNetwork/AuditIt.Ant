import{N as o,s as r}from"./index-D9XwG3Jh.js";const h=o("item",{state:()=>({items:[],loading:!1,error:null}),actions:{async fetchItems(s={}){this.loading=!0,this.error=null;try{const t=new URLSearchParams;s.warehouseId&&t.append("warehouseId",s.warehouseId.toString()),s.status&&t.append("status",s.status),s.id&&t.append("id",s.id),s.shortId&&t.append("shortId",s.shortId);const e=await r.get(`/items?${t.toString()}`);this.items=e.data}catch(t){this.error="获取库存物品失败: "+(t.response?.data?.message||t.message)}finally{this.loading=!1}},async createItem(s){this.loading=!0,this.error=null;try{const t=await r.post("/items/create",s);return this.items.unshift(t.data),t.data}catch(t){throw this.error="创建物品失败: "+(t.response?.data?.message||t.message),t}finally{this.loading=!1}},async updateItem(s,t){this.loading=!0,this.error=null;try{await r.put(`/items/${s}`,t);const e=await r.get(`/items?id=${s}`);if(e.data.length>0){const a=e.data[0],i=this.items.findIndex(n=>n.id===s);i!==-1&&(this.items[i]=a)}}catch(e){throw this.error="更新物品失败: "+(e.response?.data?.message||e.message),e}finally{this.loading=!1}},async updateItemStatus(s,t,e){this.loading=!0,this.error=null;try{const a=await r.put(`/items/${s}/${t}`,{destination:e}),i=this.items.findIndex(n=>n.id===s);i!==-1&&(this.items[i]=a.data)}catch(a){throw this.error=`物品操作 '${t}' 失败: `+(a.response?.data?.message||a.message),a}finally{this.loading=!1}},async updateStatusBatch(s,t){this.loading=!0,this.error=null;try{await r.post("/items/update-status/batch",{itemIds:s,status:t}),this.items=this.items.map(e=>s.includes(e.id)?{...e,status:t}:e)}catch(e){throw this.error="批量更新状态失败: "+(e.response?.data?.message||e.message),e}finally{this.loading=!1}}}});export{h as u};
