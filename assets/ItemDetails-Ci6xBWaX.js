import{d as N,r as R,K as _,s as T,o as q,h as V,e as v,c as a,n as A,f as e,p as c,j as O,g as s,m as n,x as o,y as p,l as U,F as Y,v as H,k as u}from"./index-rtnFcgdT.js";import{u as J}from"./itemStore-viyzyLpj.js";import{u as W}from"./auditLogStore-DzTHgpTx.js";import{u as K}from"./warehouseStore-B0UnMD02.js";import{u as Z}from"./itemDefinitionStore-DHZ8_Dlo.js";import{S as z}from"./constants-JRhsEjak.js";import{f as k}from"./formatters-By8cHG6e.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"page-container"},ee={key:0},te=N({__name:"ItemDetails",setup(ae){const B=V(),h=O(),d=J(),D=W(),f=K(),g=Z(),t=R(null),S=_(()=>t.value?.photoUrl?`${(T.defaults.baseURL||"").replace(/\/api$/,"")}${t.value.photoUrl}`:null),I=_(()=>t.value?.status?z[t.value.status]||{text:"未知",color:"gray"}:{text:"加载中...",color:"gray"}),Q=_(()=>g.itemDefinitions.find(i=>i.id===t.value?.itemDefinitionId)?.name||"加载中..."),b=_(()=>f.warehouses.find(i=>i.id===t.value?.warehouseId)?.name||"加载中...");return q(async()=>{const i=B.params.id;f.warehouses.length===0&&f.fetchWarehouses(),g.itemDefinitions.length===0&&g.fetchItemDefinitions(),await d.fetchItems({id:i}),d.items.length>0&&(t.value=d.items[0],await D.fetchLogs({itemId:i}))}),(i,m)=>{const x=s("a-button"),E=s("a-tag"),L=s("a-page-header"),r=s("a-descriptions-item"),C=s("a-descriptions"),y=s("a-col"),M=s("a-image"),G=s("a-empty"),P=s("a-row"),w=s("a-card"),j=s("a-timeline-item"),F=s("a-timeline");return u(),v("div",null,[a(L,{title:`物品详情: ${t.value?.shortId}`,onBack:m[1]||(m[1]=l=>c(h).back())},{extra:e(()=>[a(x,{onClick:m[0]||(m[0]=()=>c(h).push({name:"item-edit",params:{id:t.value?.id}}))},{default:e(()=>m[2]||(m[2]=[n("编辑",-1)])),_:1,__:[2]}),a(E,{color:I.value.color},{default:e(()=>[n(o(I.value.text),1)]),_:1},8,["color"])]),_:1},8,["title"]),A("div",X,[a(w,{loading:c(d).loading},{default:e(()=>[a(P,{gutter:16},{default:e(()=>[a(y,{span:16},{default:e(()=>[a(C,{bordered:"",column:2},{default:e(()=>[a(r,{label:"物品名称"},{default:e(()=>[n(o(Q.value),1)]),_:1}),a(r,{label:"所属仓库"},{default:e(()=>[n(o(b.value),1)]),_:1}),a(r,{label:"可视化ID"},{default:e(()=>[n(o(t.value?.shortId),1)]),_:1}),a(r,{label:"最后更新"},{default:e(()=>[n(o(c(k)(t.value?.lastUpdated)),1)]),_:1}),t.value?.status==="LoanedOut"||t.value?.status==="Disposed"?(u(),p(r,{key:0,label:"当前去向",span:2},{default:e(()=>[n(o(t.value?.currentDestination||"无"),1)]),_:1})):U("",!0),a(r,{label:"备注",span:2},{default:e(()=>[n(o(t.value?.remarks||"无"),1)]),_:1}),a(r,{label:"UUID",span:2},{default:e(()=>[n(o(t.value?.id),1)]),_:1})]),_:1})]),_:1}),a(y,{span:8},{default:e(()=>[S.value?(u(),p(M,{key:0,width:200,src:S.value,alt:"物品图片",fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBYSO_L2DLs_pWEnPErdAZ2Wa4AyGGz7Z1gAGAhImmwPAWIQLATAoPEwAX1Ls1GHi0AAAAAAABjWLNZaAAAABRnUExURQAAAPQ9Pfr6+vDw8Pv7+/T09P///9SoCg8AAAAlSURBVHja7cExAQAAAMKg9U9tCF8gAAAAAAAAAAAAAOD2A20AAAE42g4qAAAAAElFTkSuQmCC"},null,8,["src"])):(u(),p(G,{key:1,description:"暂无图片"}))]),_:1})]),_:1})]),_:1},8,["loading"]),a(w,{title:"生命周期日志",style:{"margin-top":"16px"}},{default:e(()=>[a(F,null,{default:e(()=>[(u(!0),v(Y,null,H(c(D).logs,l=>(u(),p(j,{key:l.id},{default:e(()=>[A("p",null,[A("strong",null,o(l.action),1),n(" - "+o(c(k)(l.timestamp)),1)]),A("p",null,"操作人: "+o(l.user),1),A("p",null,"仓库: "+o(l.warehouseName),1),l.destination?(u(),v("p",ee,"目的地/原因: "+o(l.destination),1)):U("",!0)]),_:2},1024))),128))]),_:1})]),_:1})])])}}}),ce=$(te,[["__scopeId","data-v-c91f822c"]]);export{ce as default};
