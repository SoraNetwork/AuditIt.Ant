import{d as m,g as d,r as n,h,i as v,j as r,k as g,a as f,c as k,w as y,b as c,e as C,l as w,m as x,o as u}from"./index-u8WKHaNm.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"callback-container"},D={class:"spin-content"},N=m({__name:"DingtalkOAuth",setup(V){const l=v(),i=g(),s=d(),e=n(null),t=n("正在处理钉钉授权...");return h(async()=>{const{code:a}=l.query;if(typeof a!="string"||!a){e.value="无效的授权码，请返回重试。",t.value="授权失败";return}t.value="授权成功, 正在登录...";try{await s.loginWithDingtalkCode(a),r.success(`欢迎回来, ${s.user?.name||"用户"}!`),i.push("/")}catch(o){e.value=o.message||"登录时发生未知错误。",t.value="登录失败",r.error(e.value)}}),(a,o)=>{const _=c("a-alert"),p=c("a-spin");return u(),f("div",A,[k(p,{tip:t.value,size:"large"},{default:y(()=>[C("div",D,[e.value?(u(),w(_,{key:0,message:e.value,type:"error","show-icon":""},null,8,["message"])):x("",!0)])]),_:1},8,["tip"])])}}}),O=B(N,[["__scopeId","data-v-c85c4ad0"]]);export{O as default};
