import{d as j,E as q,D as f,o as G,b,c as o,k as H,e as s,w as t,F as J,G as O,l as y,j as l,p as d,i as g,H as I,J as P,h as u}from"./index-DUkmHRbR.js";import{u as R}from"./itemStore-BLUAmpTr.js";import{u as $}from"./warehouseStore-Bl8Aq3ip.js";import{u as z}from"./itemDefinitionStore-cpDZ5L6q.js";import{S as K}from"./constants-B77X9tuq.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"page-container"},Y=j({__name:"InventoryView",setup(Z){const D=P(),i=R(),p=$(),v=z(),r=q({warehouseId:void 0,status:void 0}),k=a=>K[a]||{text:"未知",color:"gray"},S=f(()=>v.itemDefinitions.reduce((a,e)=>(a[e.id]=e,a),{})),N=f(()=>p.warehouses.reduce((a,e)=>(a[e.id]=e,a),{})),w=f(()=>i.items.map(a=>({...a,name:S.value[a.itemDefinitionId]?.name||"未知物品",warehouseName:N.value[a.warehouseId]?.name||"未知仓库"}))),U=[{title:"可视化ID",dataIndex:"shortId",key:"shortId"},{title:"物品名称",dataIndex:"name",key:"name"},{title:"所在仓库",dataIndex:"warehouseName",key:"warehouse"},{title:"状态",dataIndex:"status",key:"status"},{title:"最后更新",dataIndex:"lastUpdated",key:"lastUpdated"},{title:"UUID",dataIndex:"id",key:"id"}];G(()=>{i.fetchItems(),p.fetchWarehouses(),v.fetchItemDefinitions()});const C=()=>{const a={};r.warehouseId&&(a.warehouseId=Number(r.warehouseId)),r.status&&(a.status=r.status),i.fetchItems(a)};return(a,e)=>{const V=s("a-page-header"),_=s("a-select-option"),h=s("a-select"),c=s("a-form-item"),x=s("a-button"),F=s("a-form"),B=s("a-divider"),M=s("router-link"),T=s("a-tag"),A=s("a-table"),E=s("a-empty"),L=s("a-skeleton"),W=s("a-card");return u(),b("div",null,[o(V,{title:"库存总览","sub-title":"查询所有仓库中的物品状态"}),H("div",X,[o(W,null,{default:t(()=>[o(F,{layout:"inline",model:r,onFinish:C,class:"filter-form"},{default:t(()=>[o(c,{label:"仓库"},{default:t(()=>[o(h,{value:r.warehouseId,"onUpdate:value":e[0]||(e[0]=n=>r.warehouseId=n),placeholder:"所有仓库",style:{width:"180px"},"allow-clear":""},{default:t(()=>[(u(!0),b(J,null,O(y(p).warehouses,n=>(u(),d(_,{key:n.id,value:n.id},{default:t(()=>[l(I(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(c,{label:"物品状态"},{default:t(()=>[o(h,{value:r.status,"onUpdate:value":e[1]||(e[1]=n=>r.status=n),placeholder:"所有状态",style:{width:"150px"},"allow-clear":""},{default:t(()=>[o(_,{value:"InStock"},{default:t(()=>e[3]||(e[3]=[l("在库",-1)])),_:1,__:[3]}),o(_,{value:"LoanedOut"},{default:t(()=>e[4]||(e[4]=[l("借出",-1)])),_:1,__:[4]}),o(_,{value:"Disposed"},{default:t(()=>e[5]||(e[5]=[l("处置",-1)])),_:1,__:[5]})]),_:1},8,["value"])]),_:1}),o(c,null,{default:t(()=>[o(x,{type:"primary","html-type":"submit"},{default:t(()=>e[6]||(e[6]=[l("查询",-1)])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),o(B),o(L,{loading:y(i).loading,active:"",paragraph:{rows:5}},{default:t(()=>[w.value.length>0?(u(),d(A,{key:0,columns:U,"data-source":w.value,"row-key":"id"},{bodyCell:t(({column:n,record:m})=>[n.key==="shortId"?(u(),d(M,{key:0,to:{name:"item-details",params:{id:m.id}}},{default:t(()=>[l(I(m.shortId),1)]),_:2},1032,["to"])):g("",!0),n.key==="status"?(u(),d(T,{key:1,color:k(m.status).color},{default:t(()=>[l(I(k(m.status).text),1)]),_:2},1032,["color"])):g("",!0)]),_:1},8,["data-source"])):(u(),d(E,{key:1,description:"没有找到符合条件的物品，快去入库吧！"},{default:t(()=>[o(x,{type:"primary",onClick:e[2]||(e[2]=n=>y(D).push("/inbound"))},{default:t(()=>e[7]||(e[7]=[l("立即入库",-1)])),_:1,__:[7]})]),_:1}))]),_:1},8,["loading"])]),_:1})])])}}}),re=Q(Y,[["__scopeId","data-v-7239e716"]]);export{re as default};
