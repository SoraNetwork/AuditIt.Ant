import{d as j,L as q,K as f,o as E,e as g,c as o,n as K,g as s,f as a,F as O,v as P,y as d,m as l,x as y,p as v,l as D,j as $,k as u}from"./index-C0jlOoQo.js";import{u as z}from"./itemStore-Bl6-YuiB.js";import{u as G}from"./warehouseStore-DZqbp7zL.js";import{u as H}from"./itemDefinitionStore-CJASIOlj.js";import{S as J}from"./constants-JRhsEjak.js";import{f as Q}from"./formatters-wtoxksZA.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"page-container"},Z=j({__name:"InventoryView",setup(ee){const b=$(),i=z(),p=G(),I=H(),r=q({warehouseId:void 0,status:void 0}),k=t=>J[t]||{text:"未知",color:"gray"},S=f(()=>I.itemDefinitions.reduce((t,e)=>(t[e.id]=e,t),{})),N=f(()=>p.warehouses.reduce((t,e)=>(t[e.id]=e,t),{})),w=f(()=>i.items.map(t=>({...t,name:S.value[t.itemDefinitionId]?.name||"未知物品",warehouseName:N.value[t.warehouseId]?.name||"未知仓库"}))),C=[{title:"可视化ID",dataIndex:"shortId",key:"shortId"},{title:"物品名称",dataIndex:"name",key:"name"},{title:"所在仓库",dataIndex:"warehouseName",key:"warehouse"},{title:"状态",dataIndex:"status",key:"status"},{title:"当前去向",dataIndex:"currentDestination",key:"currentDestination"},{title:"备注",dataIndex:"remarks",key:"remarks"},{title:"最后更新",dataIndex:"lastUpdated",key:"lastUpdated",customRender:({text:t})=>Q(t)}];E(()=>{i.fetchItems(),p.fetchWarehouses(),I.fetchItemDefinitions()});const V=()=>{const t={};r.warehouseId&&(t.warehouseId=Number(r.warehouseId)),r.status&&(t.status=r.status),i.fetchItems(t)};return(t,e)=>{const F=s("a-page-header"),m=s("a-select-option"),h=s("a-select"),c=s("a-form-item"),x=s("a-button"),U=s("a-form"),B=s("a-divider"),M=s("router-link"),T=s("a-tag"),L=s("a-table"),A=s("a-empty"),R=s("a-skeleton"),W=s("a-card");return u(),g("div",null,[o(F,{title:"库存总览","sub-title":"查询所有仓库中的物品状态"}),K("div",Y,[o(W,null,{default:a(()=>[o(U,{layout:"inline",model:r,onFinish:V,class:"filter-form"},{default:a(()=>[o(c,{label:"仓库"},{default:a(()=>[o(h,{value:r.warehouseId,"onUpdate:value":e[0]||(e[0]=n=>r.warehouseId=n),placeholder:"所有仓库",style:{width:"180px"},"allow-clear":""},{default:a(()=>[(u(!0),g(O,null,P(v(p).warehouses,n=>(u(),d(m,{key:n.id,value:n.id},{default:a(()=>[l(y(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(c,{label:"物品状态"},{default:a(()=>[o(h,{value:r.status,"onUpdate:value":e[1]||(e[1]=n=>r.status=n),placeholder:"所有状态",style:{width:"150px"},"allow-clear":""},{default:a(()=>[o(m,{value:"InStock"},{default:a(()=>e[3]||(e[3]=[l("在库",-1)])),_:1,__:[3]}),o(m,{value:"LoanedOut"},{default:a(()=>e[4]||(e[4]=[l("借出",-1)])),_:1,__:[4]}),o(m,{value:"Disposed"},{default:a(()=>e[5]||(e[5]=[l("处置",-1)])),_:1,__:[5]})]),_:1},8,["value"])]),_:1}),o(c,null,{default:a(()=>[o(x,{type:"primary","html-type":"submit"},{default:a(()=>e[6]||(e[6]=[l("查询",-1)])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),o(B),o(R,{loading:v(i).loading,active:"",paragraph:{rows:5}},{default:a(()=>[w.value.length>0?(u(),d(L,{key:0,columns:C,"data-source":w.value,"row-key":"id"},{bodyCell:a(({column:n,record:_})=>[n.key==="shortId"?(u(),d(M,{key:0,to:{name:"item-details",params:{id:_.id}}},{default:a(()=>[l(y(_.shortId),1)]),_:2},1032,["to"])):D("",!0),n.key==="status"?(u(),d(T,{key:1,color:k(_.status).color},{default:a(()=>[l(y(k(_.status).text),1)]),_:2},1032,["color"])):D("",!0)]),_:1},8,["data-source"])):(u(),d(A,{key:1,description:"没有找到符合条件的物品，快去入库吧！"},{default:a(()=>[o(x,{type:"primary",onClick:e[2]||(e[2]=n=>v(b).push("/inbound"))},{default:a(()=>e[7]||(e[7]=[l("立即入库",-1)])),_:1,__:[7]})]),_:1}))]),_:1},8,["loading"])]),_:1})])])}}}),ue=X(Z,[["__scopeId","data-v-f803f6cd"]]);export{ue as default};
