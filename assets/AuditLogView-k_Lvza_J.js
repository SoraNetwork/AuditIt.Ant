import{u as I}from"./auditLogStore-UlmJ3cys.js";import{d as L,L as R,K as b,V as _,o as N,e as V,c as t,n as C,g as o,f as n,m as i,p as S,k as A}from"./index-BjpZBoYP.js";import{f as B}from"./formatters-06KTyIH7.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"page-container"},U=L({__name:"AuditLogView",setup(h){const u=I(),a=R({dateRange:null,action:void 0,user:""}),p=b(()=>u.logs.filter(s=>{const e=_(s.timestamp),m=!a.dateRange||e.isAfter(a.dateRange[0].startOf("day"))&&e.isBefore(a.dateRange[1].endOf("day")),c=!a.action||s.action===a.action,l=!a.user||s.user.toLowerCase().includes(a.user.toLowerCase());return m&&c&&l})),f=[{title:"时间",dataIndex:"timestamp",key:"timestamp",sorter:(s,e)=>_(s.timestamp).unix()-_(e.timestamp).unix(),defaultSortOrder:"descend",customRender:({text:s})=>B(s)},{title:"操作类型",dataIndex:"action",key:"action"},{title:"物品名称",dataIndex:"itemName",key:"itemName"},{title:"可视化ID",dataIndex:"itemShortId",key:"itemShortId"},{title:"仓库",dataIndex:"warehouseName",key:"warehouse"},{title:"操作人",dataIndex:"user",key:"user"}];return N(()=>{u.fetchLogs()}),(s,e)=>{const m=o("a-page-header"),c=o("a-range-picker"),l=o("a-form-item"),r=o("a-select-option"),v=o("a-select"),g=o("a-input"),x=o("a-form"),k=o("a-divider"),y=o("a-table"),w=o("a-card");return A(),V("div",null,[t(m,{title:"审计日志中心","sub-title":"追踪系统内的所有关键操作"}),C("div",O,[t(w,null,{default:n(()=>[t(x,{layout:"inline",model:a,class:"filter-form"},{default:n(()=>[t(l,{label:"日期范围"},{default:n(()=>[t(c,{value:a.dateRange,"onUpdate:value":e[0]||(e[0]=d=>a.dateRange=d)},null,8,["value"])]),_:1}),t(l,{label:"操作类型"},{default:n(()=>[t(v,{value:a.action,"onUpdate:value":e[1]||(e[1]=d=>a.action=d),placeholder:"所有类型",style:{width:"150px"},"allow-clear":""},{default:n(()=>[t(r,{value:"入库"},{default:n(()=>e[3]||(e[3]=[i("入库",-1)])),_:1,__:[3]}),t(r,{value:"借出"},{default:n(()=>e[4]||(e[4]=[i("借出",-1)])),_:1,__:[4]}),t(r,{value:"处置"},{default:n(()=>e[5]||(e[5]=[i("处置",-1)])),_:1,__:[5]}),t(r,{value:"归还"},{default:n(()=>e[6]||(e[6]=[i("归还",-1)])),_:1,__:[6]})]),_:1},8,["value"])]),_:1}),t(l,{label:"操作人"},{default:n(()=>[t(g,{value:a.user,"onUpdate:value":e[2]||(e[2]=d=>a.user=d),placeholder:"输入用户名","allow-clear":""},null,8,["value"])]),_:1})]),_:1},8,["model"]),t(k),t(y,{columns:f,"data-source":p.value,loading:S(u).loading,"row-key":"id"},null,8,["data-source","loading"])]),_:1})])])}}}),K=M(U,[["__scopeId","data-v-425902ca"]]);export{K as default};
