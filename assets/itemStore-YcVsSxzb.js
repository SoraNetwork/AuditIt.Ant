import{N as o,s as a}from"./index-gKLHbOSj.js";const d=o("item",{state:()=>({items:[],loading:!1,error:null}),actions:{async fetchItems(e={}){this.loading=!0,this.error=null;try{const t=new URLSearchParams;e.warehouseId&&t.append("warehouseId",e.warehouseId.toString()),e.status&&t.append("status",e.status),e.id&&t.append("id",e.id),e.shortId&&t.append("shortId",e.shortId);const s=await a.get(`/items?${t.toString()}`);this.items=s.data}catch(t){this.error="获取库存物品失败: "+(t.response?.data?.message||t.message)}finally{this.loading=!1}},async createItem(e){this.loading=!0,this.error=null;try{const t=new FormData;t.append("itemDefinitionId",String(e.itemDefinitionId)),t.append("warehouseId",String(e.warehouseId)),e.shortId&&t.append("shortId",e.shortId),e.remarks&&t.append("remarks",e.remarks),e.photo&&t.append("photo",e.photo);const s=await a.post("/items/create",t);return this.items.unshift(s.data),s.data}catch(t){throw this.error="创建物品失败: "+(t.response?.data?.message||t.message),t}finally{this.loading=!1}},async updateItem(e,t){this.loading=!0,this.error=null;try{const s=new FormData;t.remarks&&s.append("remarks",t.remarks),t.photo&&s.append("photo",t.photo),await a.put(`/items/${e}`,s),await this.fetchItems({id:e})}catch(s){throw this.error="更新物品失败: "+(s.response?.data?.message||s.message),s}finally{this.loading=!1}},async updateItemStatus(e,t,s){this.loading=!0,this.error=null;try{const r=await a.put(`/items/${e}/${t}`,{destination:s}),i=this.items.findIndex(n=>n.id===e);return i!==-1&&(this.items[i]=r.data),r.data}catch(r){throw this.error=`物品操作 '${t}' 失败: `+(r.response?.data?.message||r.message),r}finally{this.loading=!1}},async updateStatusBatch(e,t){this.loading=!0,this.error=null;try{await a.post("/items/update-status/batch",{itemIds:e,status:t}),this.items=this.items.map(s=>e.includes(s.id)?{...s,status:t}:s)}catch(s){throw this.error="批量更新状态失败: "+(s.response?.data?.message||s.message),s}finally{this.loading=!1}}}});function u(e){switch(e){case"InStock":return"在库";case"LoanedOut":return"借出";case"Disposed":return"处置";case"SuspectedMissing":return"疑似丢失";default:return"未知"}}export{u as g,d as u};
